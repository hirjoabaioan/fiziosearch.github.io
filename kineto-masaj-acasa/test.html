<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <link rel="canonical" href="" />
    <meta property="og:title" content="" />
    <meta property="og:description" content="" />
    <meta property="og:image" content="" />
    <meta property="og:url" content="" />
    <meta name="facebook-domain-verification" content="" />
    <title>Kineto și masaj | Terapeuți la tine acasă!</title>
    <link rel="icon" type="image/x-icon" href="img/icon.webp" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css" />
    <link rel="stylesheet" type="text/css" href="sass/main.css" />
    <link rel="stylesheet" href="node_modules/cropperjs/src/css/cropper.css">


    <style>
      .image-upload-box {
        margin: 3rem;
      }

      #container {
    position: relative;
    width: 10rem;
    height: 10rem;
    border: 1px solid black;
    overflow: hidden;
  }
  #image {
    position: absolute;
    cursor: move;
  }
    </style>
  </head>
  <body>
    
    <!-- <input type="file" id="imageInput">
    <canvas id="canvas"></canvas>
    <button id="compressBtn">Compress</button> -->

      <div class="image-upload-box">
        <!-- <input type="file" id="fileInput" accept="image/*">
        <div id="imageContainer">
            <img id="image" alt="Uploaded image">
        </div>
        <button id="cropButton">Crop and Compress</button>
        <img id="result" alt="Cropped and compressed image"> -->

        <input type="file" id="file-input">
        <div id="container"></div>
      </div>
  
    
      <script>
      
        const fileInput = document.getElementById('file-input');
          const container = document.getElementById('container');
      
          fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
              const img = new Image();
              img.src = URL.createObjectURL(file);
              img.onload = () => {
                img.id = 'image';
                container.innerHTML = '';
                container.appendChild(img);
                makeImageDraggable(img);
              };
            }
          });
      
          function makeImageDraggable(img) {
            let isDragging = false;
            let startX, startY, imgX, imgY;
      
            img.addEventListener('mousedown', (e) => {
              startX = e.clientX;
              startY = e.clientY;
              imgX = parseInt(img.style.left || 0);
              imgY = parseInt(img.style.top || 0);
              isDragging = true;
            });
      
            document.addEventListener('mousemove', (e) => {
              if (!isDragging) return;
              const dx = e.clientX - startX;
              const dy = e.clientY - startY;
              img.style.left = imgX + dx + 'px';
              img.style.top = imgY + dy + 'px';
            });
      
            document.addEventListener('mouseup', () => {
              if (!isDragging) return;
              isDragging = false;
              compressImage(img, 100, (compressedImg) => {
                container.innerHTML = '';
                compressedImg.id = 'image';
                container.appendChild(compressedImg);
              });
            });
          }
      
          function compressImage(img, targetSizeKB, callback) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0, img.width, img.height);
            let quality = 0.9;
            let imageData = canvas.toDataURL('image/jpeg', quality);
            while (dataURLtoBlob(imageData).size / 1024 > targetSizeKB) {
              quality -= 0.1;
              imageData = canvas.toDataURL('image/jpeg', quality);
            }
            const compressedImg = new Image();
            compressedImg.src = imageData;
            compressedImg.onload = () => callback(compressedImg);
          }
      
          function dataURLtoBlob(dataurl) {
            const arr = dataurl.split(',');
            const mime = arr[0].match(/:(.*?);/)[1];
            const bstr = atob(arr[1]);
            let n = bstr.length;
            const u8arr = new Uint8Array(n);
            while (n--) {
              u8arr[n] = bstr.charCodeAt(n);
            }
            return new Blob([u8arr], { type: mime });
          }
        </script>

      
    
    <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
    <!-- <script src="test.js"></script> -->
    <!-- <script src="node_modules\cropperjs\src\js\cropper.js"></script> -->
  </body>
</html>
